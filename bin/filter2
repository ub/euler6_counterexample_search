#!/usr/bin/env ruby

require_relative('../config/environment')

require 'benchmark'

calc_time=Benchmark.measure do
  puts "Candidates(2) count: #{Hypothesis.for_terms(2).unrefuted.unreduced.count}"
  @filter =  EulerSop6ConjectureCounterexampleSearch::Filter2.new
  Hypothesis.for_terms(2).unrefuted.unreduced.in_batches(of: 10000) do |candidates|
    @filter.filter(candidates)
  end
end
puts "Filtering time: #{calc_time}"

save_time=Benchmark.measure do
  ActiveRecord::Base.transaction do
    count = @filter.save_filter_results
    puts "Filtered(2) count: #{count}"
  end
end
puts "Writing time: #{save_time}"